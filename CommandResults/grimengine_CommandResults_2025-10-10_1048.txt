PS C:\dev\grimengine> pnpm -w build; `
>> pnpm test; `
>> pnpm run seed:characters; `
>> pnpm dev -- settings set respect-adv on; `
>> pnpm dev -- encounter start; `
>> pnpm dev -- character load-name "Kara"; `
>> pnpm dev -- encounter add pc "Kara"; `
>> pnpm dev -- encounter add goblin --n 2; `
>> pnpm dev -- encounter prone "Goblin #1" on; `
>> pnpm dev -- encounter adv "Kara" on; `
>> pnpm dev -- encounter attack "Kara" "Goblin #1" --mode melee; `
>> pnpm dev -- encounter dis "Kara" on; `
>>  pnpm dev -- encounter attack "Kara" "Goblin #2" --mode ranged; `
>>  pnpm dev -- encounter end; `
>>  pnpm dev -- character unload;

> grimengine@1.0.0 build C:\dev\grimengine
> turbo run build

turbo 2.5.8

• Packages in scope: @grimengine/cli, @grimengine/core, @grimengine/dnd5e-api, @grimengine/rules-srd
• Running build in 4 packages
• Remote caching disabled

No tasks were executed as part of this run.

 Tasks:    0 successful, 0 total
Cached:    0 cached, 0 total
  Time:    577ms

                                                                                                                                                     
> grimengine@1.0.0 test C:\dev\grimengine
> turbo run test

turbo 2.5.8

• Packages in scope: @grimengine/cli, @grimengine/core, @grimengine/dnd5e-api, @grimengine/rules-srd
• Running test in 4 packages
• Remote caching disabled
@grimengine/core:test: cache miss, executing 43da5a0d12a94b4b
@grimengine/cli:test: cache miss, executing 715c28775bf8261e
@grimengine/core:test: 
@grimengine/core:test: > @grimengine/core@0.0.0 test C:\dev\grimengine\packages\core
@grimengine/core:test: > vitest --config vitest.config.ts
@grimengine/core:test:
@grimengine/cli:test:
@grimengine/cli:test: > @grimengine/cli@0.0.0 test C:\dev\grimengine\apps\cli
@grimengine/cli:test: > vitest --config vitest.config.ts
@grimengine/cli:test:
@grimengine/cli:test: 
@grimengine/cli:test:  RUN  v3.2.4 C:/dev/grimengine/apps/cli
@grimengine/core:test:
@grimengine/cli:test:
@grimengine/core:test:  RUN  v3.2.4 C:/dev/grimengine/packages/core
@grimengine/core:test:
@grimengine/core:test:  ✓ tests/abilityScores.test.ts (9 tests) 11ms
@grimengine/core:test:  ✓ tests/encounter.test.ts (3 tests) 13ms
@grimengine/core:test:  ✓ tests/advantage.wire.test.ts (7 tests) 11ms
@grimengine/core:test:  ✓ tests/conditions.test.ts (11 tests) 13ms
@grimengine/core:test:  ✓ tests/bless.test.ts (3 tests) 12ms
@grimengine/core:test:  ✓ tests/spells.test.ts (9 tests) 18ms
@grimengine/core:test:  ✓ tests/reminders.test.ts (4 tests) 11ms
@grimengine/cli:test:  ✓ tests/encounter-snapshots.test.ts (2 tests) 14ms
@grimengine/cli:test: 
@grimengine/cli:test:  Test Files  1 passed (1)
@grimengine/cli:test:       Tests  2 passed (2)
@grimengine/cli:test:    Start at  10:46:29
@grimengine/cli:test:    Duration  1.49s (transform 475ms, setup 0ms, collect 560ms, tests 14ms, environment 0ms, prepare 309ms)
@grimengine/cli:test:
@grimengine/core:test:  ✓ tests/character.test.ts (6 tests) 12ms
@grimengine/core:test:  ✓ tests/huntersMark.test.ts (4 tests) 16ms
@grimengine/core:test:  ✓ tests/guidance_bi_reminders.test.ts (4 tests) 9ms
@grimengine/core:test:  ✓ tests/combat.test.ts (8 tests) 16ms
@grimengine/core:test:  ✓ tests/advdis.reminders.test.ts (3 tests) 8ms
@grimengine/core:test:  ✓ tests/dice.test.ts (4 tests) 9ms
@grimengine/core:test:  ✓ tests/loot.test.ts (5 tests) 10ms
@grimengine/core:test:  ✓ tests/weapons.test.ts (6 tests) 12ms
@grimengine/core:test:  ✓ tests/encounter-checks.test.ts (4 tests) 11ms
@grimengine/core:test:  ✓ tests/tags.test.ts (3 tests) 13ms
@grimengine/core:test:  ✓ tests/checks.test.ts (5 tests) 9ms
@grimengine/core:test:  ✓ tests/skills.test.ts (4 tests) 10ms
@grimengine/core:test:  ✓ tests/derived.test.ts (7 tests) 8ms
@grimengine/core:test:  ✓ tests/slots.test.ts (5 tests) 9ms
@grimengine/core:test:  ✓ tests/bardicInspiration.consume.test.ts (2 tests) 9ms
@grimengine/core:test:  ✓ tests/conditions.reminders.test.ts (3 tests) 11ms
@grimengine/core:test:  ✓ tests/concentrationDamageReminders.test.ts (4 tests) 11ms
@grimengine/core:test:  ✓ tests/concentration.test.ts (3 tests) 6ms
@grimengine/core:test:  ✓ tests/monster-normalize.test.ts (1 test) 6ms
@grimengine/core:test:  ✓ tests/derivationParity.test.ts (3 tests) 6ms
@grimengine/core:test: 
@grimengine/core:test:  Test Files  27 passed (27)
@grimengine/core:test:       Tests  130 passed (130)
@grimengine/core:test:    Start at  10:46:29
@grimengine/core:test:    Duration  3.54s (transform 1.84s, setup 0ms, collect 3.73s, tests 291ms, environment 9ms, prepare 7.16s)
@grimengine/core:test: 

 Tasks:    2 successful, 2 total
Cached:    0 cached, 2 total
  Time:    5.774s

                                                                                                                                                     
> grimengine@1.0.0 seed:characters C:\dev\grimengine
> tsx tools/seed-characters.ts

Seeded Bruni -> .data\characters\Bruni.json
Seeded Kara -> .data\characters\Kara.json

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "settings" "set" "respect-adv" "on"

respectAdv = ON

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "start"

Encounter started.

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "character" "load-name" "Kara"

Loaded character Kara (lvl 3). PB +2

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "add" "pc" "Kara"

Added PC Kara (id=kara).

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "add" "goblin" "--n" "2"

Added 2 Goblins on side 'foe': Goblin #1 (id=goblin-1), Goblin #2 (id=goblin-2)

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "prone" "Goblin #1" "on"

Goblin #1: Prone ON

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "adv" "Kara" "on"

Kara: Advantage ON

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "attack" "Kara" "Goblin #1" "--mode" "melee"

Mode: melee (conditions: none)
Advantage state: advantage
Reminder: Advantage on this attack
Reminder: Target is Prone (melee attacks: advantage; ranged attacks: disadvantage)
Attack: 1d20+2 adv vs AC 15
Rolls: [10, 16] → natural 16 → total 18 → HIT
Damage: 1d4
Rolls: [4] → base 4 → final 4
Defender Goblin #1 (id=goblin-1) now has 3/7 HP (active).

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "dis" "Kara" "on"

Kara: Disadvantage ON

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "attack" "Kara" "Goblin #2" "--mode" "ranged"

Mode: ranged (conditions: none)
Advantage state: normal
Reminder: Advantage & Disadvantage both present — they cancel out (roll normally)
Attack: 1d20+2 vs AC 15
Rolls: [2] → natural 2 → total 4 → MISS
Defender Goblin #2 (id=goblin-2) now has 7/7 HP (active).

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "end"

Encounter ended.

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "character" "unload"

Character session cleared.
PS C:\dev\grimengine> 