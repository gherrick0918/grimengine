PS C:\dev\grimengine> pnpm test

> grimengine@1.0.0 test C:\dev\grimengine
> turbo run test

turbo 2.5.8

 WARNING  Unable to calculate transitive closures: Workspace 'packages/adapters/dnd5e-api' not found in lockfile.
• Packages in scope: @grimengine/core, @grimengine/dnd5e-api, @grimengine/rules-srd
• Running test in 3 packages
• Remote caching disabled
@grimengine/core:test: cache miss, executing 97bf3594feeecd8f
@grimengine/core:test: 
@grimengine/core:test: > @grimengine/core@0.0.0 test C:\dev\grimengine\packages\core
@grimengine/core:test: > vitest --config vitest.config.ts
@grimengine/core:test:
@grimengine/core:test: 
@grimengine/core:test:  RUN  v3.2.4 C:/dev/grimengine/packages/core
@grimengine/core:test:
@grimengine/core:test:  ✓ tests/weapons.test.ts (6 tests) 11ms
@grimengine/core:test:  ✓ tests/checks.test.ts (5 tests) 9ms
@grimengine/core:test:  ✓ tests/abilityScores.test.ts (9 tests) 12ms
@grimengine/core:test:  ✓ tests/encounter.test.ts (3 tests) 12ms
@grimengine/core:test:  ✓ tests/combat.test.ts (8 tests) 13ms
@grimengine/core:test:  ✓ tests/skills.test.ts (4 tests) 8ms
@grimengine/core:test:  ✓ tests/character.test.ts (6 tests) 13ms
@grimengine/core:test:  ✓ tests/dice.test.ts (4 tests) 6ms
@grimengine/core:test:  ✓ tests/monster-normalize.test.ts (1 test) 5ms
@grimengine/core:test:  ✓ tests/derived.test.ts (7 tests) 9ms
@grimengine/core:test: 
@grimengine/core:test:  Test Files  10 passed (10)
@grimengine/core:test:       Tests  53 passed (53)
@grimengine/core:test:    Start at  12:06:09
@grimengine/core:test:    Duration  1.43s (transform 617ms, setup 0ms, collect 1.34s, tests 98ms, environment 3ms, prepare 2.63s)
@grimengine/core:test:

 Tasks:    1 successful, 1 total
Cached:    0 cached, 1 total
  Time:    3.721s

PS C:\dev\grimengine> pnpm dev -- monster fetch "Orc"                                                                                                

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "monster" "fetch" "Orc"

Orc — AC 13, HP 15
Attack: Greataxe (+5) → 1d12+3+3
Cached at C:\dev\grimengine\.data\cache\monsters\orc.json
PS C:\dev\grimengine> pnpm dev -- monster fetch "Skeleton"

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "monster" "fetch" "Skeleton"

Skeleton — AC 13, HP 13
Attack: Shortsword (+4) → 1d6+2+0
Cached at C:\dev\grimengine\.data\cache\monsters\skeleton.json
PS C:\dev\grimengine> pnpm dev -- monster list

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "monster" "list"

Cached monsters:
- Orc (orc)
- Skeleton (skeleton)
PS C:\dev\grimengine> pnpm dev -- monster show "Skeleton"

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "monster" "show" "Skeleton"

Skeleton — AC 13, HP 13
Attack: Shortsword (+4) → 1d6+2+0
PS C:\dev\grimengine> pnpm dev -- encounter start --seed grim

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "start" "--seed" "grim"

Encounter started (seed="grim").
PS C:\dev\grimengine> pnpm dev -- encounter add monster "Orc"

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "add" "monster" "Orc"

Fetched Orc from the 5e API.
Added 1 Orc: Orc #1 (id=orc-1)
PS C:\dev\grimengine> pnpm dev -- encounter add monster "Skeleton"

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "add" "monster" "Skeleton"

Fetched Skeleton from the 5e API.
Added 1 Skeleton: Skeleton #1 (id=skeleton-1)
PS C:\dev\grimengine> pnpm dev -- encounter roll-init

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "roll-init"

Initiative order:
1. Orc #1 (id=orc-1) → 17 = 16 + Dex +1
2. Skeleton #1 (id=skeleton-1) → 12 = 10 + Dex +2
PS C:\dev\grimengine> pnpm dev -- encounter list

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "list"

Encounter encounter-grim
Round: 1 | Turn: 1/2
Actors:
→ [foe] Orc #1 (id=orc-1) AC 13 HP 15/15 init=17 (roll 16)
  [foe] Skeleton #1 (id=skeleton-1) AC 13 HP 13/13 init=12 (roll 10)
PS C:\dev\grimengine> pnpm dev -- encounter attack "Orc" "Skeleton" --seed grim

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "attack" "Orc" "Skeleton" "--seed" "grim"

No actor matches "Orc".
 ELIFECYCLE  Command failed with exit code 1.
PS C:\dev\grimengine> pnpm dev -- character load ".\Characters\Aerin.json"

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "character" "load" ".\\Characters\\Aerin.json"

Loaded character Aerin (lvl 3). PB +2
PS C:\dev\grimengine> pnpm dev -- character equip --armor "Chain Mail" --shield on --weapon "Longsword" --hitdie d10

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "character" "equip" "--armor" "Chain Mail" "--shield" "on" "--weapon" "Longsword" "--hitdie" "d10"

Updated armor: Chain Mail
Updated shield: on
Updated weapon: Longsword
Updated hit die: d10
Derived:
  AC: 18    Max HP: 25 (Hit Die d10)
  Default Weapon: Longsword (to-hit +5; damage 1d8+3; versatile 1d10+3)
PS C:\dev\grimengine> pnpm dev -- encounter add pc "Aerin"

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "add" "pc" "Aerin"

Added PC Aerin (id=aerin).
PS C:\dev\grimengine> pnpm dev -- encounter roll-init

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "roll-init"

Initiative order:
1. Orc #1 (id=orc-1) → 17 = 16 + Dex +1
2. Skeleton #1 (id=skeleton-1) → 12 = 10 + Dex +2
3. Aerin (id=aerin) → 11 = 9 + Dex +2
PS C:\dev\grimengine> pnpm dev -- encounter attack "Aerin" "Skeleton" --seed grim   

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "attack" "Aerin" "Skeleton" "--seed" "grim"

No actor matches "Skeleton".
 ELIFECYCLE  Command failed with exit code 1.
PS C:\dev\grimengine> pnpm dev -- encounter attack "Aerin" "Skeleton #1" --seed grim

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "attack" "Aerin" "Skeleton #1" "--seed" "grim"

Attack: 1d20+5 vs AC 13
Rolls: [6] → natural 6 → total 11 → MISS
Defender Skeleton #1 (id=skeleton-1) now has 13/13 HP (active).
PS C:\dev\grimengine> pnpm dev -- encounter attack "Aerin" "Orc #1" --seed grim     

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "attack" "Aerin" "Orc #1" "--seed" "grim"

Attack: 1d20+5 vs AC 13
Rolls: [5] → natural 5 → total 10 → MISS
Defender Orc #1 (id=orc-1) now has 15/15 HP (active).
PS C:\dev\grimengine> pnpm dev -- encounter attack "Aerin" "Orc #1" --seed grim

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "attack" "Aerin" "Orc #1" "--seed" "grim"

Attack: 1d20+5 vs AC 13
Rolls: [5] → natural 5 → total 10 → MISS
Defender Orc #1 (id=orc-1) now has 15/15 HP (active).
PS C:\dev\grimengine> pnpm dev -- encounter end

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "encounter" "end"

Encounter ended.
PS C:\dev\grimengine> pnpm dev -- character unload

> grimengine@1.0.0 dev C:\dev\grimengine
> tsx apps/cli/index.ts "character" "unload"

Character session cleared.
PS C:\dev\grimengine> 